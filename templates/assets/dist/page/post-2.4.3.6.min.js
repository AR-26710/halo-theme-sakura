import{d as m,s,_ as T,U as h,I as y}from"../main-2.4.3.6.min.js";import"../assets/_commonjsHelpers-042e6b4d.js";var C=Object.defineProperty,w=Object.getOwnPropertyDescriptor,p=(f,o,i,t)=>{for(var e=t>1?void 0:t?w(o,i):o,r=f.length-1,n;r>=0;r--)(n=f[r])&&(e=(t?n(o,i,e):n(e))||e);return t&&e&&C(o,i,e),e};class u{addMarkTextSpan(){const o=document.querySelectorAll("mark");o&&o.forEach(i=>{const t=i.childNodes;t&&t.forEach(e=>{if(e.nodeType===3){const r=document.createElement("span");r.className="mark-text",r.textContent=e.textContent,e.replaceWith(r)}})})}autoCalculateSubmenuPosition(){const o=s.getThemeConfig("post","reward",Array);if(!o||o.length===0)return;const i=document.querySelector(".reward-open");if(!i)return;const t=i.querySelector(".reward-main");if(!t)return;const e=i.offsetWidth;t.style.visibility="hidden",t.style.display="block";const r=t.offsetWidth;console.log(e,r),t.style.display="none",t.style.visibility="visible";const n=e/2-r/2;t.style.left=`${n}px`}registerOriginalPostCopy(){var i;const o=document.querySelector(".entry-content");o&&(s.getPageConfig("isOriginal")=="false"||!((i=s.getThemeConfig("post","post_original_copy",Boolean))!=null&&i.valueOf())||o.addEventListener("copy",t=>{t.preventDefault();const e=window.getSelection();if(!e)return;const r=e.toString();if(!r||r.length<30)return;const n=document.querySelector(".post-article");if(!n)return;const a=n.getAttribute("data-owner"),l=n.getAttribute("data-url"),c=n.getAttribute("data-siteName");let d=`
      ${s.translate("post.copyright_template_html.info","# 商业转载请联系作者获得授权，非商业转载请注明出处。<br>")}
      ${s.translate("post.copyright_template_html.license","# 协议(License): 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)<br>")}
      ${s.translate("post.copyright_template_html.author",`# 作者(Author): ${a} <br>`,{postAuthor:a})}
      ${s.translate("post.copyright_template_html.url",`# 链接(URL): ${l} <br>`,{postUrl:l})}
      ${s.translate("post.copyright_template_html.url",`# 来源(Source): ${c} <br>`,{siteName:c})}
      <br>
      `;const g=e.toString(),_=`${d}${g.replace(/\r\n/g,"<br>")}`,b=`${d.replace(/<br>/g,`
`)}${g.replace(/\r\n/g,`
`)}`;t.clipboardData&&(t.clipboardData.setData("text/html",_),t.clipboardData.setData("text/plain",b))}))}async registerShareWechat(){const o=document.getElementById("qrcode");if(!o)return;(await T(()=>import("../assets/browser-21db0a97.js").then(t=>t.b),[])).toCanvas(o,o.getAttribute("data-url"),{width:120,color:{dark:"#000000",light:"#ffffff"}})}registerWordCountToast(){var e,r;if(!((e=s.getThemeConfig("post","post_word_count_toast",Boolean))!=null&&e.valueOf()))return;const o=document.querySelector(".entry-content");if(!o||document.querySelector(".single-page-header"))return;const t=h.getWordCount(o);if(t>0){const n=h.caclEstimateReadTime(t);let a="NORMAL";n<=60*10?a="NORMAL":n>60*10&&n<=60*30?a="MEDIUM":a="DIFFICULTY";let l="";const c=y.secondToTimeString(n);if(window.innerWidth>860){const d={normal:"文章篇幅适中，可以放心阅读。",medium:"文章比较长，建议分段阅读。",difficulty:"文章内容已经很陈旧了，也许不再适用！"};l=((r=s.getThemeConfig("post",`post_word_count_toast_${a.toLowerCase()}`,String))==null?void 0:r.valueOf())||s.translate("post.word_count_toast.remind",d[a.toLowerCase()],{context:a.toLowerCase()})}this.createPostToast(o,s.translate("post.word_count_toast.content",`文章共 <b>${t}</b> 字，阅读完预计需要 <b>${c}</b>。${l}`,{postWordCount:t,timeString:c,remind:l}),a,"word_count")}}registerEditTimeToast(){var l,c;const o=document.querySelector(".entry-content");if(!o||!((l=s.getThemeConfig("post","post_edit_time_toast",Boolean))!=null&&l.valueOf())||!s.getPageConfig("postLastModifyTime"))return;const i=s.getPageConfig("postLastModifyTime"),t=new Date(i),e=new Date().getTime()-t.getTime();let r="NORMAL";e<=1e3*60*60*24*30?r="NORMAL":e>1e3*60*60*24*30&&e<=1e3*60*60*24*90?r="MEDIUM":r="DIFFICULTY";let n="";if(window.innerWidth>860){const d={normal:"近期有所更新，请放心阅读！",medium:"文章内容已经有一段时间没有更新了，也许不再适用！",difficulty:"文章内容已经很陈旧了，也许不再适用！"};n=((c=s.getThemeConfig("post",`post_edit_time_toast_${r.toLowerCase()}`,String))==null?void 0:c.valueOf())||s.translate("post.edit_time_toast.remind",d[r.toLowerCase()],{context:r.toLowerCase()})}const a=y.RelativeTimeFormat(t.getTime());this.createPostToast(o,s.translate("post.edit_time_toast.content",`文章内容上次编辑时间于 <b>${a}</b>。${n}`,{sinceLastTime:a,remind:n}),r,"last_time")}createPostToast(o,i,t,e){const n=`<div class="${e} minicode" style="background-color: ${{NORMAL:"rgba(167, 210, 226, 1)",MEDIUM:"rgba(255, 197, 160, 1)",DIFFICULTY:"rgba(239, 206, 201, 1)"}[t]}">
      <span class="content-toast">
        ${i}
      </span>
      <div class="hide-minicode flex-child-center">
        <span class="iconify iconify--small" data-icon="ic:sharp-close"></span>
      </div>
    </div>`;if(o.querySelector(`.${e}`))return;const c=new DOMParser().parseFromString(n,"text/html").querySelector(`.${e}`);c.querySelector(".hide-minicode").addEventListener("click",()=>{c.classList.add("hide")},{once:!0}),o.insertAdjacentElement("afterbegin",c)}}p([m()],u.prototype,"addMarkTextSpan",1);p([m()],u.prototype,"autoCalculateSubmenuPosition",1);p([m()],u.prototype,"registerOriginalPostCopy",1);p([m()],u.prototype,"registerShareWechat",1);p([m()],u.prototype,"registerWordCountToast",1);p([m()],u.prototype,"registerEditTimeToast",1);
